{% extends '_layout/_profile.html.twig' %}
{% block profile_body %}
    <div class="col-md-4">
        <div id="treeCategory" class="well" data-url="{{ path("ajax_category_tree") }}"
             data-route_name="{{ app.request.get('_route') }}" data-is_admin="1"></div>
    </div>
    <div class="col-md-8">
        <h3>Родительская категория</h3>
        <p id="parent_category">Не выбрана</p>
        {{ form(form) }}
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {% javascripts '@category_admin_create_js' output='bundles/js/*' %}
    <script src="{{ asset(asset_url) }}" type="text/javascript"></script>
    {% endjavascripts %}

    <script type="text/javascript">
        function set_categories(node, selected, event) {
            $('#category_create_parent').val(selected.node.id);
            $('#parent_category').text(selected.node.text);
        }
        $(document).ready(function () {
            var url = $('#treeCategory').data('url');
            var route_name = $('#treeCategory').data('route_name');
            var is_admin = $('#treeCategory').data('is_admin');
            $('#treeCategory').jstree({
                core: {
                    data: {
                        url: url + '?route_name=' + route_name + '&is_admin=' + is_admin
                    }
                }
            }).on("select_node.jstree", set_categories);

        });
    </script>
{% endblock %}