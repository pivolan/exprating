<script type="text/javascript">
    $('#{{ treeId }}').jstree({
        core: {
            data: [
                {{ include('_include/Category/_jsTree.json.twig', {'categories': categories, 'category': category}) }}
            ]
        }
    }).bind("select_node.jstree", function (e, data) {
        $('#jstree').jstree('save_state');
    }).on("activate_node.jstree", function (e, data) {
        History.pushState(null, null, data.node.a_attr.href);
    });
    $(document).on('click', 'ul.pagination li a', function (event) {
        event.preventDefault();
        var $this = this;
        var href = $($this).attr('href');
        History.pushState(null, null, href);
    });
    History.Adapter.bind(window, 'statechange', function () {
        var State = History.getState();
        History.log(State.data, State.title, State.url);
        $('div.history_category').load(State.url);
    });

</script>
